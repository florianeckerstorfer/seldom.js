!function(e,t){"use strict";"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define(["exports","require"],function(){return t()}):e.Seldom=t()}(window,function(){var e=function(e,t,n,i){this.domlight=e||new Domlight,this.clicklight=t||new Domlight,this.similarlight=n||new Domlight,this.options=this.constructor.defaultOptions;for(var o in i)this.options[o]=i[o]};return e.defaultOptions={},e.prototype.getDeepestElementWithContent=function(e){for(var t=e.textContent,n=e,i=e.childNodes.length-1;i>=0;i--)1===e.childNodes[i].nodeType&&e.childNodes[i].textContent===t&&(n=this.getDeepestElementWithContent(e.childNodes[i]),null===n&&(n=e.childNodes[i]));return n},e.prototype.select=function(e,t){for(var n,i=this,o=e.querySelectorAll("*"),r=function(e){e.target!=n&&(i.domlight.unlight(n),n=e.target,i.domlight.highlight(n))},l=function(e){e.preventDefault(),e.stopPropagation();for(var n=o.length-1;n>=0;n--)o[n].removeEventListener("mousemove",r,!1),o[n].removeEventListener("click",l,!0);i.domlight.unlightAll(o),i.clicklight.unlightAll(o),i.clicklight.highlight(e.target),t(e.target)},a=o.length-1;a>=0;a--){var d=o[a];d.addEventListener("click",l,!0),d.addEventListener("mousemove",r,!1)}},e.prototype.refineSelection=function(e,t){var n=this,i=[],o=function(){var t=n.computePosition(e),i=t.y2,o=t.x1;i>window.pageYOffset+window.innerHeight-30&&(i=t.y1-35),i<window.pageYOffset&&(i+=35),o=o<=0?0:o,i=i<=0?0:i,g.style.left=o+"px",g.style.top=i+"px"},r=function(t){e=t,o(),f()},l=function(){for(var e=0;e<i.length;e+=1)n.similarlight.unlight(i[e]);i=[]},a=function(){l(),n.switchDomlight(n.clicklight,e,e.parentNode),r(e.parentNode)},d=function(){l(),e.children[0]&&(n.switchDomlight(n.clicklight,e,e.children[0]),r(e.children[0]))},c=function(){l();var t=n.prevRealSibling(e);t&&(n.switchDomlight(n.clicklight,e,t),r(t))},s=function(){l();var t=n.nextRealSibling(e);t&&(n.switchDomlight(n.clicklight,e,t),r(t))},u=function(){l();for(var t=n.findSimilar(e),o=0;o<t.length;o+=1)t[o]!==e&&(n.similarlight.highlight(t[o]),i.push(t[o]))},h=function(){document.body.removeChild(g),t(e,i)},p=function(){var e=document.createElement("div");e.className="seldom__refine-selection";var t=document.createElement("a");t.classList.add("parent"),t.appendChild(document.createTextNode("Parent")),t.addEventListener("click",a);var n=document.createElement("a");n.classList.add("first-child"),n.appendChild(document.createTextNode("First Child")),n.addEventListener("click",d);var i=document.createElement("a");i.classList.add("prev-sibling"),i.appendChild(document.createTextNode("Previous Sibling")),i.addEventListener("click",c);var o=document.createElement("a");o.classList.add("next-sibling"),o.appendChild(document.createTextNode("Next Sibling")),o.addEventListener("click",s);var r=document.createElement("a");r.classList.add("find-similar"),r.appendChild(document.createTextNode("Find Similar")),r.addEventListener("click",u);var l=document.createElement("a");return l.classList.add("done"),l.appendChild(document.createTextNode("Done")),l.addEventListener("click",h),e.appendChild(t),e.appendChild(n),e.appendChild(i),e.appendChild(o),e.appendChild(r),e.appendChild(l),e},f=function(){var t=g.querySelector(".next-sibling"),i=g.querySelector(".prev-sibling"),o=g.querySelector(".first-child"),r=g.querySelector(".parent");null===n.nextRealSibling(e)?t.classList.add("inactive"):t.classList.remove("inactive"),null===n.prevRealSibling(e)?i.classList.add("inactive"):i.classList.remove("inactive"),e.children[0]?o.classList.remove("inactive"):o.classList.add("inactive"),e.parentNode?r.classList.remove("inactive"):r.classList.add("inactive")},g=p();o(g),document.body.appendChild(g)},e.prototype.prevRealSibling=function(e){for(var t=e.previousSibling;t&&1!==t.nodeType;)t=t.previousSibling;return t&&1===t.nodeType?t:null},e.prototype.nextRealSibling=function(e){for(var t=e.nextSibling;t&&1!==t.nodeType;)t=t.nextSibling;return t&&1===t.nodeType?t:null},e.prototype.findSimilar=function(e){var t=[];if(e.className)for(var n=e.className.split(" "),i=0;i<n.length;i+=1)for(var o=document.querySelectorAll(e.tagName+"."+n[i]),r=0;r<o.length;r+=1)this.nodeInArray(t,o[r])||t.push(o[r]);if(0===t.length){for(var l="",a=e;a.parentNode;)l=a.tagName+(l.length>0?">"+l:""),a=a.parentNode;console.log("selector",l),t=document.querySelectorAll(l)}return t},e.prototype.switchDomlight=function(e,t,n){e.unlight(t),e.highlight(n)},e.prototype.computePosition=function(e){var t=document.createRange();t.selectNode(e);var n=t.getBoundingClientRect(),i=window.pageXOffset+n.left,o=window.pageYOffset+n.top;return{x1:i,x2:i+n.width,y1:o,y2:o+n.height}},e.prototype.nodeInArray=function(e,t){for(var n=0;n<e.length;n+=1)if(e[n]===t)return!0;return!1},e.prototype.addEvent=function(e,t,n,i){"undefined"!=typeof e.addEventListener?"mouseenter"===t?e.addEventListener("mouseover",this.mouseEnter(n),i):"mouseleave"===t?e.addEventListener("mouseout",this.mouseEnter(n),i):e.addEventListener(t,n,i):"undefined"!=typeof e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n},e.prototype.mouseEnter=function(e){var t=this;return function(n){var i=n.relatedTarget;this===i||t.isChildOf(this,i)||e.call(this,n)}},e.prototype.isChildOf=function(e,t){if(e===t)return!1;for(;t&&t!==e;)t=t.parentNode;return t===e},e});