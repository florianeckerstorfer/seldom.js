!function(e,t){"use strict";"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define(["exports","require"],function(){return t()}):e.Seldom=t()}(window,function(){var e=function(e,t,i,n){this.domlight=e||new Domlight,this.clicklight=t||new Domlight,this.similarlight=i||new Domlight,this.options=this.constructor.defaultOptions;for(var o in n)this.options[o]=n[o]};return e.defaultOptions={},e.prototype.getDeepestElementWithContent=function(e){for(var t=e.textContent,i=e,n=e.childNodes.length-1;n>=0;n--)1===e.childNodes[n].nodeType&&e.childNodes[n].textContent===t&&(i=this.getDeepestElementWithContent(e.childNodes[n]),null===i&&(i=e.childNodes[n]));return i},e.prototype.select=function(e,t){for(var i,n=this,o=e.querySelectorAll("*"),r=function(e){e.target!=i&&(n.domlight.unlight(i),i=e.target,n.domlight.highlight(i))},l=function(e){e.preventDefault(),e.stopPropagation();for(var i=o.length-1;i>=0;i--)o[i].removeEventListener("mousemove",r,!1),o[i].removeEventListener("click",l,!0);n.domlight.unlightAll(o),n.clicklight.unlightAll(o),n.clicklight.highlight(e.target),t(e.target)},d=o.length-1;d>=0;d--){var a=o[d];a.addEventListener("click",l,!0),a.addEventListener("mousemove",r,!1)}},e.prototype.refineSelection=function(e,t){var i=this,n=[],o=function(){var t=i.computePosition(e),n=t.y2,o=t.x1;n>window.pageYOffset+window.innerHeight-30&&(n=t.y1-35),n<window.pageYOffset&&(n+=35),o=o<=0?0:o,n=n<=0?0:n,g.style.left=o+"px",g.style.top=n+"px"},r=function(t){e=t,o(),f()},l=function(){for(var e=0;e<n.length;e+=1)i.similarlight.unlight(n[e]);n=[]},d=function(){l(),i.switchDomlight(i.clicklight,e,e.parentNode),r(e.parentNode)},a=function(){l(),e.children[0]&&(i.switchDomlight(i.clicklight,e,e.children[0]),r(e.children[0]))},c=function(){l();var t=i.prevRealSibling(e);t&&(i.switchDomlight(i.clicklight,e,t),r(t))},s=function(){l();var t=i.nextRealSibling(e);t&&(i.switchDomlight(i.clicklight,e,t),r(t))},u=function(){l();for(var t=i.findSimilar(e),o=0;o<t.length;o+=1)t[o]!==e&&(i.similarlight.highlight(t[o]),n.push(t[o]))},h=function(){document.body.removeChild(g),t(e,n)},p=function(){var e=document.createElement("div");e.className="seldom__refine-selection";var t=document.createElement("a");t.classList.add("parent"),t.appendChild(document.createTextNode("Parent")),t.addEventListener("click",d);var i=document.createElement("a");i.classList.add("first-child"),i.appendChild(document.createTextNode("First Child")),i.addEventListener("click",a);var n=document.createElement("a");n.classList.add("prev-sibling"),n.appendChild(document.createTextNode("Previous Sibling")),n.addEventListener("click",c);var o=document.createElement("a");o.classList.add("next-sibling"),o.appendChild(document.createTextNode("Next Sibling")),o.addEventListener("click",s);var r=document.createElement("a");r.classList.add("find-similar"),r.appendChild(document.createTextNode("Find Similar")),r.addEventListener("click",u);var l=document.createElement("a");return l.classList.add("done"),l.appendChild(document.createTextNode("Done")),l.addEventListener("click",h),e.appendChild(t),e.appendChild(i),e.appendChild(n),e.appendChild(o),e.appendChild(r),e.appendChild(l),e},f=function(){var t=g.querySelector(".next-sibling"),n=g.querySelector(".prev-sibling"),o=g.querySelector(".first-child"),r=g.querySelector(".parent");null===i.nextRealSibling(e)?t.classList.add("inactive"):t.classList.remove("inactive"),null===i.prevRealSibling(e)?n.classList.add("inactive"):n.classList.remove("inactive"),e.children[0]?o.classList.remove("inactive"):o.classList.add("inactive"),e.parentNode?r.classList.remove("inactive"):r.classList.add("inactive")},g=p();o(g),document.body.appendChild(g)},e.prototype.prevRealSibling=function(e){for(var t=e.previousSibling;t&&1!==t.nodeType;)t=t.previousSibling;return t&&1===t.nodeType?t:null},e.prototype.nextRealSibling=function(e){for(var t=e.nextSibling;t&&1!==t.nodeType;)t=t.nextSibling;return t&&1===t.nodeType?t:null},e.prototype.findSimilar=function(e){var t=[];if(e.className)for(var i=e.className.split(" "),n=0;n<i.length;n+=1)for(var o=document.querySelectorAll(e.tagName+"."+i[n]),r=0;r<o.length;r+=1)this.nodeInArray(t,o[r])||t.push(o[r]);return t},e.prototype.switchDomlight=function(e,t,i){e.unlight(t),e.highlight(i)},e.prototype.computePosition=function(e){var t=document.createRange();t.selectNode(e);var i=t.getBoundingClientRect(),n=window.pageXOffset+i.left,o=window.pageYOffset+i.top;return{x1:n,x2:n+i.width,y1:o,y2:o+i.height}},e.prototype.nodeInArray=function(e,t){for(var i=0;i<e.length;i+=1)if(e[i]===t)return!0;return!1},e.prototype.addEvent=function(e,t,i,n){"undefined"!=typeof e.addEventListener?"mouseenter"===t?e.addEventListener("mouseover",this.mouseEnter(i),n):"mouseleave"===t?e.addEventListener("mouseout",this.mouseEnter(i),n):e.addEventListener(t,i,n):"undefined"!=typeof e.attachEvent?e.attachEvent("on"+t,i):e["on"+t]=i},e.prototype.mouseEnter=function(e){var t=this;return function(i){var n=i.relatedTarget;this===n||t.isChildOf(this,n)||e.call(this,i)}},e.prototype.isChildOf=function(e,t){if(e===t)return!1;for(;t&&t!==e;)t=t.parentNode;return t===e},e});